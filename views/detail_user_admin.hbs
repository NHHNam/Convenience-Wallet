{{!-- nav  --}}
{{>navAdmin}}
{{!-- end nav --}}

{{!-- body --}}
<div class="container mt-5 mb-5">
    <h2>Chi tiết người dùng</h2>    
    <small>
        <a href="/admin//list/user_wait">Back</a>
    </small>
    <div class="shadow-none p-3 mb-5 bg-light rounded">
        {{#each data}}
            <div class="row">
                <div class="col-lg-6">
                    <label style="font-size: 20px; font-weight: 500;" for="">Email</label>
                    <p>{{email}}</p>
                </div>
                <div class="col-lg-6">
                    <label style="font-size: 20px; font-weight: 500;" for="">Name</label>
                    <p>{{name}}</p>
                </div>
            </div>

            <div>
                <label style="font-size: 20px; font-weight: 500;" for="">SDT</label>
                <div>{{sdt}}</div>
            </div>

            <div>
                <label style="font-size: 20px; font-weight: 500;" for="">Address</label>
                <div>{{diachi}}</div>
            </div>

            <div>
                <label style="font-size: 20px; font-weight: 500;" for="">Username</label>
                <div>{{username}}</div>
            </div>
            <div class="row">
                <div class="col-lg-6">
                    <label style="font-size: 20px; font-weight: 500;" for="">CCCD mặt trước</label>
                    <div><img style="max-width: 200px; max-height: 200px;" src="/{{image_cccd_truoc}}" alt=""></div>
                </div>

                <div class="col-lg-6">
                    <label style="font-size: 20px; font-weight: 500;" for="">CCCD mặt sau</label>
                    <div><img style="max-width: 200px; max-height: 200px;" src="/{{image_cccd_sau}}" alt=""></div>
                </div>
            </div>
            <div class="row mt-5">
                <div class="col-lg-4">
                    <button class="btn btn-primary" data-email="{{email}}" id="approveBTN">Xác minh</button>
                </div>

                <div class="col-lg-4">
                    <button class="btn btn-danger" data-email="{{email}}" id="cancelBTN">Hủy</button>
                </div>

                <div class="col-lg-4">
                    <button class="btn btn-success" id="complementaryBTN">Yêu cầu bổ sung</button>
                </div>
            </div>
        {{/each}}
    </div>
    <div id="message"></div>
</div>


{{!-- end body --}}


{{!-- script js --}}

<script>
    const complementaryBTN = document.getElementById('complementaryBTN'),
    cancelBTN = document.getElementById('cancelBTN'),
    approveBTN = document.getElementById('approveBTN')

    approveBTN.addEventListener('click', () => {
        let email = $('#approveBTN').attr('data-email')
        var http = new XMLHttpRequest();
        var url = `http://localhost:5000/admin/detailUser/`;
        var params = `email=${email}`;
        http.open('POST', url, true);

        //Send the proper header information along with the request
        http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');

        http.onreadystatechange = function() {//Call a function when the state changes.
            if(http.readyState == 4 && http.status == 200) {
                $('#message').css('color', 'green')
                $('#message').css('font-size', "20px")
                $('#message').css('font-weight', '500')
                $('#message').html(http.responseText)
                setInterval(() => {
                    location.href = '/admin//list/user_wait'
                }, 3000)
            }
        }
        http.send(params);
    })

    // handle cancel activated account
    cancelBTN.addEventListener('click', () => {
        let email = $('#cancelBTN').attr('data-email')
        var http = new XMLHttpRequest();
        var url = `http://localhost:5000/admin/cancelActivated/`;
        var params = `email=${email}`;
        http.open('POST', url, true);

        //Send the proper header information along with the request
        http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');

        http.onreadystatechange = function() {//Call a function when the state changes.
            if(http.readyState == 4 && http.status == 200) {
                $('#message').css('color', 'red')
                $('#message').css('font-size', "20px")
                $('#message').css('font-weight', '500')
                $('#message').html(http.responseText)
                setInterval(() => {
                    location.href = '/admin//list/user_wait'
                }, 3000)
            }
        }
        http.send(params);
    })
</script>